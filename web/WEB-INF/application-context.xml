<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.1.xsd">

    <!-- DAOs -->
    <bean id="eventDao"
          class="ua.epam.spring.hometask.dao.impl.EventDaoImpl">
    </bean>

    <bean id="ticketDao"
          class="ua.epam.spring.hometask.dao.impl.TicketDaoImpl">
    </bean>

    <bean id="userDao"
          class="ua.epam.spring.hometask.dao.impl.UserDaoImpl">
    </bean>


    <!-- Services -->
    <bean id="auditoriumService"
          class="ua.epam.spring.hometask.service.impl.AuditoriumServiceImpl">
        <constructor-arg>
            <set>
                <bean id="auditoriumRed" class="ua.epam.spring.hometask.domain.Auditorium"
                      p:name="${one.name}"
                      p:numberOfSeats="${one.numberOfSeats}"
                      p:vipSeats="#{'${one.vipSeats}'.split(',')}"/>
                <bean id="auditoriumYellow" class="ua.epam.spring.hometask.domain.Auditorium"
                      p:name="${two.name}"
                      p:numberOfSeats="${two.numberOfSeats}"
                      p:vipSeats="#{'${two.vipSeats}'.split(',')}"/>
                <bean id="auditoriumBlue" class="ua.epam.spring.hometask.domain.Auditorium"
                      p:name="${three.name}"
                      p:numberOfSeats="${three.numberOfSeats}"
                      p:vipSeats="#{'${three.vipSeats}'.split(',')}"/>
            </set>
        </constructor-arg>
    </bean>

    <bean id="userService"
          class="ua.epam.spring.hometask.service.impl.UserServiceImpl">
        <constructor-arg ref="userDao"/>
    </bean>

    <bean id="bookingService"
          class="ua.epam.spring.hometask.service.impl.BookingServiceImpl">
        <constructor-arg ref="discountService"/>
        <constructor-arg ref="ticketDao"/>
    </bean>

    <bean id="discountService"
          class="ua.epam.spring.hometask.service.impl.DiscountServiceImpl">
        <constructor-arg>
            <list>
                <ref bean="birthdayDiscountStrategy"/>
                <ref bean="wholesaleDiscountStrategy"/>
            </list>
        </constructor-arg>
    </bean>

    <bean id="eventService"
          class="ua.epam.spring.hometask.service.impl.EventServiceImpl">
        <constructor-arg ref="eventDao"/>
    </bean>


    <!-- Discount Strategies -->
    <bean id="birthdayDiscountStrategy"
          class="ua.epam.spring.hometask.strategy.impl.BirthdayDiscountStrategy">
    </bean>

    <bean id="wholesaleDiscountStrategy"
          class="ua.epam.spring.hometask.strategy.impl.WholesaleDiscountStrategy">
        <constructor-arg ref="ticketDao"/>
    </bean>


    <!-- Property Configurer -->
    <bean id="propertyConfigurer" class="org.springframework.context.support.PropertySourcesPlaceholderConfigurer">
        <property name="locations">
            <list>
                <value>classpath:auditoriums.properties</value>
            </list>
        </property>
        <property name="ignoreResourceNotFound" value="false"/>
    </bean>
    <!--<context:property-placeholder location="file:auditoriums.properties"/>-->

</beans>
